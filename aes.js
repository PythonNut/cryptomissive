/**
* @license Gibberish-AES 
* A lightweight Javascript Libray for OpenSSL compatible AES CBC encryption.
*
* Author: Mark Percival
* Email: mark@mpercival.com
* Copyright: Mark Percival - http://mpercival.com 2008
*
* With thanks to:
* Josh Davis - http://www.josh-davis.org/ecmaScrypt
* Chris Veness - http://www.movable-type.co.uk/scripts/aes.html
* Michel I. Gallant - http://www.jensign.com/
* Jean-Luc Cooke <jlcooke@certainkey.com> 2012-07-12: added strhex + invertArr to compress G2X/G3X/G9X/GBX/GEX/SBox/SBoxInv/Rcon saving over 7KB, and added encString, decString, also made the MD5 routine more easlier compressible using yuicompressor.
*
* License: MIT
*
* Usage: GibberishAES.enc("secret", "password")
* Outputs: AES Encrypted text encoded in Base64
*/

(function(t,q){"object"===typeof exports?module.exports=q():"function"===typeof define&&define.amd?define(q):t.GibberishAES=q()})(this,function(){var t=14,q=8,u=!1,L=function(a,d){var b="",c,e;if(d){c=a[15];if(16<c)throw"Decryption error: Maybe bad key";if(16===c)return"";for(e=0;e<16-c;e++)b+=String.fromCharCode(a[e])}else for(e=0;16>e;e++)b+=String.fromCharCode(a[e]);return b},w=function(a,d){var b=[],c;if(!d)try{a=unescape(encodeURIComponent(a))}catch(e){throw"Error on UTF-8 encode";}for(c=0;c<
a.length;c++)b[c]=a.charCodeAt(c);return b},G=function(a,d){var b=12<=t?3:2,c=[],e=[],c=[],e=[],p=a.concat(d),m;c[0]=F(p);e=c[0];for(m=1;m<b;m++)c[m]=F(c[m-1].concat(p)),e=e.concat(c[m]);c=e.slice(0,4*q);e=e.slice(4*q,4*q+16);return{key:c,iv:e}},N=function(a,d,b){d=H(d);var c=Math.ceil(a.length/16),e=[],p,m=[];for(p=0;p<c;p++){var l=p,q=a.slice(16*p,16*p+16),t=[],r=void 0,r=void 0;16>q.length&&(r=16-q.length,t=[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]);for(r=0;r<q.length;r++)t[r]=q[r];e[l]=t}0===a.length%
16&&e.push([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]);for(p=0;p<e.length;p++)e[p]=0===p?x(e[p],b):x(e[p],m[p-1]),m[p]=M(e[p],d);return m},P=function(a,d,b,c){d=H(d);var e=a.length/16,p=[],m,l=[],q="";for(m=0;m<e;m++)p.push(a.slice(16*m,16*(m+1)));for(m=p.length-1;0<=m;m--)l[m]=O(p[m],d),l[m]=0===m?x(l[m],b):x(l[m],p[m-1]);for(m=0;m<e-1;m++)q+=L(l[m],!1);var q=q+L(l[m],!0),t;if(c)t=q;else try{t=decodeURIComponent(escape(q))}catch(r){throw"Bad Key";}return t},M=function(a,d){u=!1;var b=y(a,
d,0),c;for(c=1;c<t+1;c++)b=Q(b),b=R(b),c<t&&(b=S(b)),b=y(b,d,c);return b},O=function(a,d){u=!0;var b=y(a,d,t),c;for(c=t-1;-1<c;c--)b=R(b),b=Q(b),b=y(b,d,c),0<c&&(b=S(b));return b},Q=function(a){var d=u?U:I,b=[],c;for(c=0;16>c;c++)b[c]=d[a[c]];return b},R=function(a){var d=[],b=u?[0,13,10,7,4,1,14,11,8,5,2,15,12,9,6,3]:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],c;for(c=0;16>c;c++)d[c]=a[b[c]];return d},S=function(a){var d=[],b;if(u)for(b=0;4>b;b++)d[4*b]=z[a[4*b]]^A[a[1+4*b]]^B[a[2+4*b]]^C[a[3+4*b]],
d[1+4*b]=C[a[4*b]]^z[a[1+4*b]]^A[a[2+4*b]]^B[a[3+4*b]],d[2+4*b]=B[a[4*b]]^C[a[1+4*b]]^z[a[2+4*b]]^A[a[3+4*b]],d[3+4*b]=A[a[4*b]]^B[a[1+4*b]]^C[a[2+4*b]]^z[a[3+4*b]];else for(b=0;4>b;b++)d[4*b]=D[a[4*b]]^E[a[1+4*b]]^a[2+4*b]^a[3+4*b],d[1+4*b]=a[4*b]^D[a[1+4*b]]^E[a[2+4*b]]^a[3+4*b],d[2+4*b]=a[4*b]^a[1+4*b]^D[a[2+4*b]]^E[a[3+4*b]],d[3+4*b]=E[a[4*b]]^a[1+4*b]^a[2+4*b]^D[a[3+4*b]];return d},y=function(a,d,b){var c=[],e;for(e=0;16>e;e++)c[e]=a[e]^d[b][e];return c},x=function(a,d){var b=[],c;for(c=0;16>
c;c++)b[c]=a[c]^d[c];return b},H=function(a){var d=[],b=[],c,e,p=[];for(c=0;c<q;c++)e=[a[4*c],a[4*c+1],a[4*c+2],a[4*c+3]],d[c]=e;for(c=q;c<4*(t+1);c++){d[c]=[];for(a=0;4>a;a++)b[a]=d[c-1][a];if(0===c%q){a=b[0];e=void 0;for(e=0;3>e;e++)b[e]=b[e+1];b[3]=a;b=T(b);b[0]^=V[c/q-1]}else 6<q&&4===c%q&&(b=T(b));for(a=0;4>a;a++)d[c][a]=d[c-q][a]^b[a]}for(c=0;c<t+1;c++)for(p[c]=[],b=0;4>b;b++)p[c].push(d[4*c+b][0],d[4*c+b][1],d[4*c+b][2],d[4*c+b][3]);return p},T=function(a){for(var d=0;4>d;d++)a[d]=I[a[d]];
return a},J=function(a,d){var b,c=[];for(b=0;b<a.length;b+=d)c[b/d]=parseInt(a.substr(b,d),16);return c},v=function(a){var d,b=[];for(d=0;256>d;d++){for(var c=d,e=a,p=d,m=void 0,l=void 0,m=l=0;8>m;m++)l=1===(p&1)?l^e:l,e=127<e?283^e<<1:e<<1,p>>>=1;b[c]=l}return b},I=J("637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0b7fd9326363ff7cc34a5e5f171d8311504c723c31896059a071280e2eb27b27509832c1a1b6e5aa0523bd6b329e32f8453d100ed20fcb15b6acbbe394a4c58cfd0efaafb434d338545f9027f503c9fa851a3408f929d38f5bcb6da2110fff3d2cd0c13ec5f974417c4a77e3d645d197360814fdc222a908846eeb814de5e0bdbe0323a0a4906245cc2d3ac629195e479e7c8376d8dd54ea96c56f4ea657aae08ba78252e1ca6b4c6e8dd741f4bbd8b8a703eb5664803f60e613557b986c11d9ee1f8981169d98e949b1e87e9ce5528df8ca1890dbfe6426841992d0fb054bb16",
2),U=function(a){var d,b=[];for(d=0;d<a.length;d++)b[a[d]]=d;return b}(I),V=J("01020408102040801b366cd8ab4d9a2f5ebc63c697356ad4b37dfaefc591",2),D=v(2),E=v(3),C=v(9),A=v(11),B=v(13),z=v(14),F=function(a){function d(a,b){var c,d,e,f,g;e=a&2147483648;f=b&2147483648;c=a&1073741824;d=b&1073741824;g=(a&1073741823)+(b&1073741823);return c&d?g^2147483648^e^f:c|d?g&1073741824?g^3221225472^e^f:g^1073741824^e^f:g^e^f}function b(a,b,c,e,g,f,h){a=d(a,d(d(b&c|~b&e,g),h));return d(a<<f|a>>>32-f,b)}function c(a,
b,c,e,f,g,h){a=d(a,d(d(b&e|c&~e,f),h));return d(a<<g|a>>>32-g,b)}function e(a,b,c,e,g,f,h){a=d(a,d(d(b^c^e,g),h));return d(a<<f|a>>>32-f,b)}function p(a,b,c,e,f,g,h){a=d(a,d(d(c^(b|~e),f),h));return d(a<<g|a>>>32-g,b)}function m(a){var b,c,e=[];for(c=0;3>=c;c++)b=a>>>8*c&255,e=e.concat(b);return e}var l=[],q,t,r,u,f,g,h,k,n=J("67452301efcdab8998badcfe10325476d76aa478e8c7b756242070dbc1bdceeef57c0faf4787c62aa8304613fd469501698098d88b44f7afffff5bb1895cd7be6b901122fd987193a679438e49b40821f61e2562c040b340265e5a51e9b6c7aad62f105d02441453d8a1e681e7d3fbc821e1cde6c33707d6f4d50d87455a14eda9e3e905fcefa3f8676f02d98d2a4c8afffa39428771f6816d9d6122fde5380ca4beea444bdecfa9f6bb4b60bebfbc70289b7ec6eaa127fad4ef308504881d05d9d4d039e6db99e51fa27cf8c4ac5665f4292244432aff97ab9423a7fc93a039655b59c38f0ccc92ffeff47d85845dd16fa87e4ffe2ce6e0a30143144e0811a1f7537e82bd3af2352ad7d2bbeb86d391",
8),l=function(a){var b,c=a.length;b=c+8;for(var e=16*((b-b%64)/64+1),d=[],g=0,f=0;f<c;)b=(f-f%4)/4,g=f%4*8,d[b]|=a[f]<<g,f++;b=(f-f%4)/4;d[b]|=128<<f%4*8;d[e-2]=c<<3;d[e-1]=c>>>29;return d}(a);f=n[0];g=n[1];h=n[2];k=n[3];for(a=0;a<l.length;a+=16)q=f,t=g,r=h,u=k,f=b(f,g,h,k,l[a+0],7,n[4]),k=b(k,f,g,h,l[a+1],12,n[5]),h=b(h,k,f,g,l[a+2],17,n[6]),g=b(g,h,k,f,l[a+3],22,n[7]),f=b(f,g,h,k,l[a+4],7,n[8]),k=b(k,f,g,h,l[a+5],12,n[9]),h=b(h,k,f,g,l[a+6],17,n[10]),g=b(g,h,k,f,l[a+7],22,n[11]),f=b(f,g,h,k,l[a+
8],7,n[12]),k=b(k,f,g,h,l[a+9],12,n[13]),h=b(h,k,f,g,l[a+10],17,n[14]),g=b(g,h,k,f,l[a+11],22,n[15]),f=b(f,g,h,k,l[a+12],7,n[16]),k=b(k,f,g,h,l[a+13],12,n[17]),h=b(h,k,f,g,l[a+14],17,n[18]),g=b(g,h,k,f,l[a+15],22,n[19]),f=c(f,g,h,k,l[a+1],5,n[20]),k=c(k,f,g,h,l[a+6],9,n[21]),h=c(h,k,f,g,l[a+11],14,n[22]),g=c(g,h,k,f,l[a+0],20,n[23]),f=c(f,g,h,k,l[a+5],5,n[24]),k=c(k,f,g,h,l[a+10],9,n[25]),h=c(h,k,f,g,l[a+15],14,n[26]),g=c(g,h,k,f,l[a+4],20,n[27]),f=c(f,g,h,k,l[a+9],5,n[28]),k=c(k,f,g,h,l[a+14],9,
n[29]),h=c(h,k,f,g,l[a+3],14,n[30]),g=c(g,h,k,f,l[a+8],20,n[31]),f=c(f,g,h,k,l[a+13],5,n[32]),k=c(k,f,g,h,l[a+2],9,n[33]),h=c(h,k,f,g,l[a+7],14,n[34]),g=c(g,h,k,f,l[a+12],20,n[35]),f=e(f,g,h,k,l[a+5],4,n[36]),k=e(k,f,g,h,l[a+8],11,n[37]),h=e(h,k,f,g,l[a+11],16,n[38]),g=e(g,h,k,f,l[a+14],23,n[39]),f=e(f,g,h,k,l[a+1],4,n[40]),k=e(k,f,g,h,l[a+4],11,n[41]),h=e(h,k,f,g,l[a+7],16,n[42]),g=e(g,h,k,f,l[a+10],23,n[43]),f=e(f,g,h,k,l[a+13],4,n[44]),k=e(k,f,g,h,l[a+0],11,n[45]),h=e(h,k,f,g,l[a+3],16,n[46]),
g=e(g,h,k,f,l[a+6],23,n[47]),f=e(f,g,h,k,l[a+9],4,n[48]),k=e(k,f,g,h,l[a+12],11,n[49]),h=e(h,k,f,g,l[a+15],16,n[50]),g=e(g,h,k,f,l[a+2],23,n[51]),f=p(f,g,h,k,l[a+0],6,n[52]),k=p(k,f,g,h,l[a+7],10,n[53]),h=p(h,k,f,g,l[a+14],15,n[54]),g=p(g,h,k,f,l[a+5],21,n[55]),f=p(f,g,h,k,l[a+12],6,n[56]),k=p(k,f,g,h,l[a+3],10,n[57]),h=p(h,k,f,g,l[a+10],15,n[58]),g=p(g,h,k,f,l[a+1],21,n[59]),f=p(f,g,h,k,l[a+8],6,n[60]),k=p(k,f,g,h,l[a+15],10,n[61]),h=p(h,k,f,g,l[a+6],15,n[62]),g=p(g,h,k,f,l[a+13],21,n[63]),f=p(f,
g,h,k,l[a+4],6,n[64]),k=p(k,f,g,h,l[a+11],10,n[65]),h=p(h,k,f,g,l[a+2],15,n[66]),g=p(g,h,k,f,l[a+9],21,n[67]),f=d(f,q),g=d(g,t),h=d(h,r),k=d(k,u);return m(f).concat(m(g),m(h),m(k))},K=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=a.split("");"function"===typeof Array.indexOf&&(a=d);return{encode:function(a,c){var e=[],p="",m;for(m=0;m<16*a.length;m++)e.push(a[Math.floor(m/16)][m%16]);for(m=0;m<e.length;m+=3)p+=d[e[m]>>2],p+=d[(e[m]&3)<<4|e[m+1]>>4],p=void 0!==
e[m+1]?p+d[(e[m+1]&15)<<2|e[m+2]>>6]:p+"=",p=void 0!==e[m+2]?p+d[e[m+2]&63]:p+"=";e=p.slice(0,64)+"\n";for(m=1;m<Math.ceil(p.length/64);m++)e+=p.slice(64*m,64*m+64)+(Math.ceil(p.length/64)===m+1?"":"\n");return e},decode:function(b){b=b.replace(/\n/g,"");var c=[],e=[],d=[],m;for(m=0;m<b.length;m+=4)e[0]=a.indexOf(b.charAt(m)),e[1]=a.indexOf(b.charAt(m+1)),e[2]=a.indexOf(b.charAt(m+2)),e[3]=a.indexOf(b.charAt(m+3)),d[0]=e[0]<<2|e[1]>>4,d[1]=(e[1]&15)<<4|e[2]>>2,d[2]=(e[2]&3)<<6|e[3],c.push(d[0],d[1],
d[2]);return c=c.slice(0,c.length-c.length%16)}}}();return{size:function(a){switch(a){case 128:t=10;q=4;break;case 192:t=12;q=6;break;case 256:t=14;q=8;break;default:throw"Invalid Key Size Specified:"+a;}},h2a:function(a){var d=[];a.replace(/(..)/g,function(a){d.push(parseInt(a,16))});return d},expandKey:H,encryptBlock:M,decryptBlock:O,Decrypt:u,s2a:w,rawEncrypt:N,rawDecrypt:P,dec:function(a,d,b){a=K.decode(a);var c=a.slice(8,16),c=G(w(d,b),c);d=c.key;c=c.iv;a=a.slice(16,a.length);return a=P(a,d,
c,b)},openSSLKey:G,a2h:function(a){var d="",b;for(b=0;b<a.length;b++)d+=(16>a[b]?"0":"")+a[b].toString(16);return d},enc:function(a,d,b){var c;c=[];var e;for(e=0;8>e;e++)c=c.concat(Math.floor(256*Math.random()));e=G(w(d,b),c);d=e.key;e=e.iv;c=[[83,97,108,116,101,100,95,95].concat(c)];a=w(a,b);a=N(a,d,e);a=c.concat(a);return K.encode(a)},Hash:{MD5:F},Base64:K}});
